import{_ as C}from"./-O6qpLwq.js";import{_ as f,v as y,z as h,e as _,k,j as v}from"./G7D_4P1p.js";const O={__name:"map",props:{polygon:{type:Object,default:()=>({})}},setup(x){let r=null;const u={},m=d=>{r=d,ymaps.ready(()=>{const t=new ymaps.GeoObject({geometry:{type:"Point"},properties:{iconCaption:"Адрес"}},{preset:"islands#blackDotIconWithCaption",draggable:!0,iconCaptionMaxWidth:"215"}),a=new ymaps.control.SearchControl({options:{useMapBounds:!0,strictBounds:!0,noPlacemark:!0,placeholderContent:"Введите адрес доставки"}});r.geoObjects.add(t),r.controls.add(a);const o=ymaps.geoQuery(u.value).addToMap(r);o.each(function(e){e.options.set({fillColor:e.properties.get("fill"),fillOpacity:e.properties.get("fill-opacity"),strokeColor:e.properties.get("stroke"),strokeWidth:e.properties.get("stroke-width"),strokeOpacity:e.properties.get("stroke-opacity")}),e.properties.set("balloonContent",e.properties.get("description"))}),a.events.add("resultshow",function(e){l(a.getResultsArray()[e.get("index")])}),r.controls.get("geolocationControl").events.add("locationchange",function(e){l(e.get("geoObjects").get(0))}),t.events.add("dragstart",function(){t.properties.set({iconCaption:"",balloonContent:""}),t.options.set("iconColor","black")}),t.events.add("dragend",function(){l(t)});function l(e){var i=e.geometry.getCoordinates(),p=o.searchContaining(i).get(0);p?(o.setOptions("fillOpacity",.4),p.options.set("fillOpacity",.8),t.geometry.setCoordinates(i),t.options.set("iconColor",p.properties.get("fill")),typeof e.getThoroughfare=="function"?g(e):ymaps.geocode(i,{results:1}).then(function(n){var s=n.geoObjects.get(0);g(s)})):(o.setOptions("fillOpacity",.4),t.geometry.setCoordinates(i),t.properties.set({iconCaption:"Доставка транспортной компанией",balloonContent:"Cвяжитесь с оператором",balloonContentHeader:""}),t.options.set("iconColor","black"));function g(n){let s=[n.getThoroughfare(),n.getPremiseNumber(),n.getPremise()].join(" ");s.trim()===""&&(s=n.getAddressLine());let c=p.properties.get("description");c=c.match(/<strong>(.+)<\/strong>/)[1],t.properties.set({iconCaption:s,balloonContent:s,balloonContentHeader:c})}}})};return(d,t)=>{const a=y("YandexMap"),o=C;return _(),h(o,null,{default:k(()=>[v(a,{class:"map",zoom:9,coordinates:[30.264981955459618,59.9567962610097],behaviors:["drag","multiTouch"],controls:["zoomControl","geolocationControl"],onCreated:m})]),_:1})}}},w=f(O,[["__scopeId","data-v-2242a47c"]]);export{w as default};
